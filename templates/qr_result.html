{% extends "base.html" %}

{% block title %}Transmission Ready{% endblock %}

{% block content %}
<div class="container text-center mt-5">

    <div class="icon-container mb-4">
        <div class="lock-icon">üîí</div>
    </div>

    <h2 class="fw-bold mb-2">Encrypted Transmission Ready</h2>
    <p class="text-muted mb-4">The data for <strong>"{{ title }}"</strong> has been secured.</p>

    <div class="position-relative d-inline-block">
        <img src="{{ qr_url }}" alt="Secure QR Code" class="qr-image border border-3 border-success rounded shadow-lg mb-4"
             style="max-width:300px; padding: 10px; background: white; opacity: 0; transform: translateY(10px); transition: all 0.8s ease-out;">
        <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger"
              style="opacity: 0; animation: fadeBadge 1s forwards 1.5s;">AES-128 + HMAC</span>
    </div>

    <div class="action-buttons d-flex flex-column align-items-center gap-3" style="opacity: 0; transform: translateY(10px); transition: all 0.8s ease-out;">

        <a href="{{ pdf_url }}" target="_blank" class="btn btn-warning px-5 py-3 rounded-pill fw-bold shadow-sm">
            <i class="bi bi-file-earmark-pdf-fill me-2"></i> Download Classified Report
        </a>

        <div class="d-flex gap-2">
            <a href="{{ qr_url }}" download="{{ file_name }}" class="btn btn-dark px-4 py-2 rounded-pill">
                ‚¨áÔ∏è PNG Only
            </a>
            <a href="{% url 'generate_qr_code' %}" class="btn btn-outline-secondary px-4 py-2 rounded-pill">
                üîÑ New Mission
            </a>
        </div>

        <div class="alert alert-light mt-3 border" role="alert" style="max-width: 400px;">
            <small class="text-muted">
                <strong>Log ID:</strong> Data access will be audited. <br>
                Tampering with this QR code will trigger a security alert.
            </small>
        </div>
    </div>
</div>

<style>
    .lock-icon { font-size: 80px; animation: pop-in 0.6s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
    @keyframes pop-in { 0% { transform: scale(0); opacity: 0; } 80% { transform: scale(1.1); opacity: 1; } 100% { transform: scale(1); opacity: 1; } }
    @keyframes fadeBadge { from { opacity: 0; } to { opacity: 1; } }
</style>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const qrImage = document.querySelector('.qr-image');
        const actionButtons = document.querySelector('.action-buttons');
        setTimeout(() => { qrImage.style.opacity = 1; qrImage.style.transform = 'translateY(0)'; }, 500);
        setTimeout(() => { actionButtons.style.opacity = 1; actionButtons.style.transform = 'translateY(0)'; }, 1200);
    });
</script>
{% endblock %}